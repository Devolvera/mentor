var mentor=mentor||{},ENTER_KEY=13;$(function(){function r(e,n){var r=e.text(),s=e.text().length;$(".max-chars").text(n-s);if(s>n&&r!=t){var o=n-s,u=r.substr(o);u=$('<i class="overspill">'+u+"<i>");var a=r.slice(0,o);e.text(a);e.append(u);i();$(".max-chars").removeClass("valid").addClass("exceeded")}else s>0&&s<=n?$(".max-chars").removeClass("exceeded").addClass("valid"):s==0&&$(".max-chars").removeClass("valid").removeClass("exceeded")}function i(){var e,t,n=document.getElementById("advice-replacer");if(document.createRange){e=document.createRange();e.selectNodeContents(n);e.collapse(!1);t=window.getSelection();t.removeAllRanges();t.addRange(e)}else if(document.selection){e=document.body.createTextRange();e.moveToElementText(n);e.collapse(!1);e.select()}}var e=new mentor.Router($("#content"));Backbone.history.start();$("body").on("click",".button__primary",function(t){t.preventDefault();t.stopPropagation();var n=$("#droplet");n.animate({opacity:0},500,function(){e.switchView(e.randomDroplet)})});$(".submit-modal textarea").hide();$("[data-hide-on-load]").hide();$("[data-toggle]").on("click",function(e){e.preventDefault();var t=$(this).attr("data-toggle");t=$(t);$(this).attr("data-toggle-method")=="fade"?$(t).fadeToggle(300):$(t).slideToggle(300);t.find("[contenteditable]").length&&t.find("[contenteditable]").focus()});$("[data-toggle-body]").click(function(e){e.preventDefault();var t=$(this).attr("data-toggle-body");$("body").toggleClass(t)});var t,n=140;$(".advice-replacer").on("keydown",function(){t=$(this).text()}).on("keyup",function(){r($(this),n)}).on("paste",function(e){var t=$(this);setTimeout(function(){t.text(t.text());r(t,n)},0);r(t,n)})});